<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tesla Electricidad y Automatizaci√≥n S.A.C - Landing Producci√≥n 2025</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Poppins', sans-serif; margin: 0; padding: 0; background: #f4f4f4; color: #333; }
    header { background: linear-gradient(135deg, #003366, #0066cc); color: white; padding: 20px; text-align: center; }
    header h1 { margin: 0; font-size: 2rem; }
    .hero { text-align: center; padding: 60px 20px; background: #003366; color: white; }
    .hero h2 { font-size: 2.5rem; margin-bottom: 15px; }
    .hero p { font-size: 1.2rem; }
    .cta { margin-top: 20px; background: #ff0000; color: white; padding: 12px 30px; border-radius: 25px; display: inline-block; text-decoration: none; font-weight: 600; }

    /* === DASHBOARD === */
    .dashboard { padding: 40px 20px; background: white; }
    .dashboard h2 { text-align: center; color: #003366; margin-bottom: 20px; }
    .metrics { display: flex; justify-content: space-around; text-align: center; margin-bottom: 30px; }
    .metric { flex: 1; }
    .metric h3 { color: #0066cc; margin-bottom: 5px; }
    .metric p { font-size: 1.1rem; font-weight: bold; }
    .chart { display: flex; justify-content: space-around; align-items: flex-end; height: 250px; border-left: 2px solid #ccc; border-bottom: 2px solid #ccc; margin: 20px auto; max-width: 700px; }
    .bar { width: 60px; background: linear-gradient(180deg, #0066cc, #003366); border-radius: 5px 5px 0 0; position: relative; }
    .bar span { position: absolute; top: -25px; left: 50%; transform: translateX(-50%); font-size: 0.9rem; color: #333; }

    /* === SERVICES === */
    .services { padding: 40px 20px; background: #f9f9f9; }
    .services h2 { text-align: center; color: #003366; margin-bottom: 30px; }
    .service-grid { display: grid; grid-template-columns: repeat(auto-fit,minmax(280px,1fr)); gap: 20px; }
    .service-card { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); text-align: center; }
    .service-card h3 { color: #003366; margin-bottom: 10px; }
    .service-card p { font-size: 0.95rem; color: #555; }

    /* === CHATBOT === */
    .chatbot { padding: 40px 20px; background: #003366; color: white; text-align: center; }
    .chatbot h2 { margin-bottom: 20px; }
    .chat-window { max-width: 600px; margin: 0 auto; background: white; color: #333; border-radius: 10px; padding: 20px; text-align: left; height: 300px; overflow-y: auto; }
    .chat-window p { margin: 10px 0; }

    /* === SOCIAL === */
    .social { padding: 40px 20px; background: #f9f9f9; text-align: center; }
    .social h2 { color: #003366; margin-bottom: 20px; }
    .social a { margin: 0 10px; font-size: 1.5rem; color: #003366; text-decoration: none; }

    footer { background: #001a33; color: white; text-align: center; padding: 20px; }
    .secure { background: #fff; padding: 40px 20px; text-align: center; border-top: 4px solid #003366; }
    .secure h2 { color: #003366; margin-bottom: 20px; }
    .secure p { max-width: 700px; margin: 0 auto; color: #555; }
  
    /* ===== Dashboard avanzado (restaurado) ===== */
    .dashboard { padding: 80px 20px; background: #fff; position: relative; }
    .dashboard h2 { text-align: center; color: #003366; margin-bottom: 10px; font-size: 2.2rem; }
    .dashboard .sub { text-align:center; color:#666; max-width:820px; margin:0 auto 30px; }
    .month-selector { display:flex; flex-wrap:wrap; justify-content:center; gap:10px; margin-bottom:30px; }
    .month-btn { padding:10px 18px; font-weight:600; border:0; border-radius:24px; background:#fff; color:#003366; cursor:pointer; box-shadow:0 4px 12px rgba(0,0,0,.06); transition:.25s; }
    .month-btn:hover { transform: translateY(-2px); background:#f1f5f9; }
    .month-btn.active { background:#003366; color:#fff; box-shadow:0 8px 18px rgba(0,51,102,.25); }
    .dashboard-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(320px,1fr)); gap:28px; max-width:1200px; margin:0 auto; }
    .db-card { background:#fff; border-radius:18px; box-shadow:0 10px 28px rgba(0,0,0,.08); padding:26px; display:flex; flex-direction:column; }
    .db-card h3 { color:#003366; margin:0 0 16px; font-size:1.2rem; }
    .chart-wrap { position:relative; height:300px; }
    .chart { display:flex; align-items:flex-end; justify-content:space-around; height:100%; border-left:2px solid #e5e7eb; border-bottom:2px solid #e5e7eb; padding:10px 6px 0; }
    .chart-bar { width:40px; border-radius:6px 6px 0 0; position:relative; transition:height .7s cubic-bezier(.2,.8,.2,1); }
    .chart-bar[data-service="itse"]{ background:linear-gradient(180deg,#007bff,#0056b3); }
    .chart-bar[data-service="pozo"]{ background:linear-gradient(180deg,#28a745,#1e7e34); }
    .chart-bar[data-service="mant"]{ background:linear-gradient(180deg,#ffc107,#d39e00); }
    .chart-bar[data-service="inc"]{ background:linear-gradient(180deg,#dc3545,#b02a37); }
    .chart-bar .tip { position:absolute; top:-28px; left:50%; transform:translateX(-50%); background:#111; color:#fff; padding:4px 8px; border-radius:6px; font-size:.85rem; opacity:0; pointer-events:none; transition:opacity .2s; white-space:nowrap; }
    .chart-bar:hover .tip{ opacity:1; }
    .chart-labels { display:flex; justify-content:space-around; margin-top:10px; }
    .chart-labels span{ width:70px; text-align:center; color:#555; font-weight:600; }
    .kpi-grid{ display:grid; grid-template-columns:repeat(3,1fr); gap:18px; }
    .kpi{ text-align:center; padding:16px; border-radius:14px; background:#f8fafc; border:1px solid #eef2f7; }
    .kpi .icon{ font-size:1.8rem; margin-bottom:6px; }
    .kpi .val{ font-size:2rem; font-weight:800; color:#003366; }
    .kpi .lbl{ color:#667085; font-size:.9rem; }
  </style>
</head>
<body>
  <header>
    <h1>Tesla Electricidad y Automatizaci√≥n S.A.C</h1>
  </header>

  <section class="hero">
    <h2>Expertos en Seguridad El√©ctrica y Certificaci√≥n ITSE</h2>
    <p>Garantizamos la operatividad y legalidad de tu negocio en Huancayo</p>
    <a href="#contacto" class="cta">Cotizar ahora ‚ö°</a>
  </section>

  <!-- DASHBOARD CON M√âTRICAS + GR√ÅFICO -->
  <section class="dashboard" id="dashboard">
    <h2>Nuestro Crecimiento en 2025</h2>
    <p class="sub">Simulaci√≥n conectable a m√©tricas reales. Selecciona un mes para ver servicios realizados y KPIs clave. (Los datos reales se cargan desde el backend si est√° disponible).</p>

    <div class="month-selector" id="monthSelector"></div>

    <div class="dashboard-grid">
      <div class="db-card" id="mainChartCard">
        <h3>Servicios por tipo (<span id="monthLabelA">Agosto</span>)</h3>
        <div class="chart-wrap">
          <div class="chart" id="mainChart"></div>
          <div class="chart-labels" id="chartLabels"></div>
        </div>
      </div>
      <div class="db-card">
        <h3>M√©tricas clave (<span id="monthLabelB">Agosto</span>)</h3>
        <div class="kpi-grid">
          <div class="kpi"><div class="icon">üë•</div><div class="val" id="kpiClients">0</div><div class="lbl">Nuevos clientes</div></div>
          <div class="kpi"><div class="icon">üõ†Ô∏è</div><div class="val" id="kpiTotal">0</div><div class="lbl">Servicios totales</div></div>
          <div class="kpi"><div class="icon">‚≠ê</div><div class="val" id="kpiCSAT">0%</div><div class="lbl">Satisfacci√≥n</div></div>
        </div>
      </div>
    </div>
  </section>

  <section class="services">
    <h2>Nuestros Servicios</h2>
    <div class="service-grid">
      <div class="service-card"><h3>üìã Certificado ITSE</h3><p>Gesti√≥n integral de inspecciones t√©cnicas de seguridad en edificaciones.</p></div>
      <div class="service-card"><h3>‚ö° Pozo de Tierra</h3><p>Instalaci√≥n y mantenimiento de sistemas de puesta a tierra confiables.</p></div>
      <div class="service-card"><h3>üîß Mantenimiento El√©ctrico</h3><p>Planes preventivos y correctivos para maximizar la productividad.</p></div>
      <div class="service-card"><h3>üßØ Sistema Contra Incendios</h3><p>Dise√±o e instalaci√≥n de sistemas de detecci√≥n y alarma contra incendios.</p></div>
      <div class="service-card"><h3>üìä Dise√±o de Tableros</h3><p>Fabricaci√≥n de tableros el√©ctricos de control y distribuci√≥n personalizados.</p></div>
      <div class="service-card"><h3>üõí Venta de Suministros</h3><p>Stock completo de materiales el√©ctricos de alta calidad.</p></div>
    </div>
  </section>

  <section class="chatbot">
    <h2>ü§ñ TeslaBot - Asistente 24/7</h2>
    <div class="chat-window" id="chat-window">
      <p><strong>TeslaBot:</strong> ¬°Hola! Soy tu asistente el√©ctrico inteligente. ¬øSobre qu√© servicio deseas informaci√≥n?</p>
    </div>
    <input type="text" id="user-input" placeholder="Escribe tu mensaje..." style="padding:10px; width:60%; border-radius:5px; border:none; margin-top:15px;">
    <button onclick="sendMessage()" style="padding:10px 20px; border:none; border-radius:5px; background:#ff0000; color:white; font-weight:600;">Enviar</button>
  </section>

  <section class="secure">
    <h2>üîí Seguridad y Protecci√≥n de Datos</h2>
    <p>Todos nuestros servicios est√°n respaldados por un backend seguro. Tus datos personales, as√≠ como las integraciones con APIs externas (WhatsApp, Telegram, OpenAI, Gemini, Microsoft o cualquier proveedor), son gestionados mediante una carpeta dedicada de seguridad donde se almacenan las claves API de forma encriptada. Esto garantiza confidencialidad y cumplimiento de est√°ndares internacionales de protecci√≥n.</p>
  </section>

  <section class="social">
    <h2>S√≠guenos en Redes Sociales</h2>
    <a href="#">üì± TikTok</a>
    <a href="#">üì∑ Instagram</a>
    <a href="#">üìò Facebook</a>
  </section>

  <footer>
    <p>&copy; 2025 Tesla Electricidad y Automatizaci√≥n S.A.C. Todos los derechos reservados.</p>
  </footer>

  <script>
    const chatWindow = document.getElementById('chat-window');
    const userInput = document.getElementById('user-input');

    function appendMessage(sender, message) {
      const p = document.createElement('p');
      p.innerHTML = `<strong>${sender}:</strong> ${message}`;
      chatWindow.appendChild(p);
      chatWindow.scrollTop = chatWindow.scrollHeight;
    }

    function ruleBasedReply(text) {
      text = text.toLowerCase();
      if (text.includes('itse')) return 'El pago municipal aprox. es S/218 y gesti√≥n desde S/300 (referencial). ¬øAgendamos una visita t√©cnica gratuita?';
      if (text.includes('pozo')) return 'Un pozo a tierra completo cuesta entre S/1500 y S/2500 seg√∫n el terreno. ¬øQuieres coordinar una visita t√©cnica?';
      if (text.includes('mantenimiento')) return 'Nuestros planes de mantenimiento se adaptan a tu negocio. Podemos agendar una evaluaci√≥n gratuita. ¬øTe interesa?';
      if (text.includes('incendio')) return 'Los sistemas contra incendios se cotizan seg√∫n √°rea y riesgo. Incluyen detectores y alarmas. ¬øDeseas una inspecci√≥n inicial sin costo?';
      return 'Puedo darte informaci√≥n sobre ITSE, pozos a tierra, mantenimiento el√©ctrico o sistemas contra incendios. ¬øCu√°l necesitas?';
    }

    function sendMessage() {
      const text = userInput.value.trim();
      if (!text) return;
      appendMessage('Usuario', text);
      const reply = ruleBasedReply(text);
      setTimeout(() => appendMessage('TeslaBot', reply), 600);
      userInput.value = '';
    }

    userInput.addEventListener('keypress', e => {
      if (e.key === 'Enter') sendMessage();
    });
  
  // ===== Dashboard avanzado (JS) =====
  (function(){
    const API_BASE = (location.hostname === 'localhost' || location.hostname === '127.0.0.1') ? 'http://127.0.0.1:8000' : '';
    const months = ["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"]; // listo para ampliar
    const full = ["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];
    const serviceKeys = { itse:"ITSE", pozo:"Pozos", mant:"Mantenim.", inc:"Incendios" };

    // Datos locales (fallback) como los que trabajamos juntos
    const localMonthly = [
      { clients:5,  csat:92, services:{itse:2, pozo:3, mant:10, inc:1}},
      { clients:6,  csat:93, services:{itse:3, pozo:4, mant:11, inc:2}},
      { clients:8,  csat:94, services:{itse:4, pozo:5, mant:14, inc:2}},
      { clients:7,  csat:95, services:{itse:5, pozo:5, mant:15, inc:3}},
      { clients:8,  csat:95, services:{itse:6, pozo:3, mant:15, inc:4}},
      { clients:10, csat:96, services:{itse:7, pozo:6, mant:18, inc:5}},
      { clients:12, csat:97, services:{itse:8, pozo:7, mant:20, inc:7}},
      { clients:15, csat:98, services:{itse:9, pozo:8, mant:22, inc:8}}
    ];

    const monthSelector = document.getElementById('monthSelector');
    const mainChart = document.getElementById('mainChart');
    const chartLabels = document.getElementById('chartLabels');

    function el(tag, attrs={}){ const n=document.createElement(tag); Object.assign(n, attrs); return n; }
    function fmt(n){ return new Intl.NumberFormat('es-PE').format(n); }
    function animateNum(elm, val, suffix=''){ let start=0; const dur=500; const t0=performance.now(); const tick=(t)=>{ const p=Math.min(1,(t-t0)/dur); elm.textContent=fmt(Math.floor(start+(val-start)*p))+suffix; if(p<1) requestAnimationFrame(tick); }; requestAnimationFrame(tick); }

    function renderSkeleton(){
      months.slice(0, localMonthly.length).forEach((m,idx)=>{
        const b=el('button',{className:'month-btn', innerText:m});
        b.addEventListener('click',()=>update(idx));
        monthSelector.appendChild(b);
      });
      Object.keys(serviceKeys).forEach(k=>{
        const bar=el('div',{className:'chart-bar'}); bar.dataset.service=k; bar.innerHTML='<div class="tip">0</div>'; mainChart.appendChild(bar);
        const lab=el('span',{innerText:serviceKeys[k]}); chartLabels.appendChild(lab);
      });
    }

    function maxServiceOf(month){ return Math.max(...Object.values(month.services)); }

    function update(i){
      document.querySelectorAll('.month-btn').forEach((b,idx)=> b.classList.toggle('active', idx===i));
      const data = (window.__remoteMonthly && window.__remoteMonthly[i]) || localMonthly[i] || localMonthly[localMonthly.length-1];
      document.getElementById('monthLabelA').textContent = full[i] || 'Agosto';
      document.getElementById('monthLabelB').textContent = full[i] || 'Agosto';
      const total = Object.values(data.services).reduce((a,b)=>a+b,0);
      animateNum(document.getElementById('kpiClients'), data.clients);
      animateNum(document.getElementById('kpiTotal'), total);
      animateNum(document.getElementById('kpiCSAT'), data.csat, '%');
      const maxV = Math.max(1, maxServiceOf(data));
      Object.entries(data.services).forEach(([k,v])=>{
        const bar = document.querySelector(`.chart-bar[data-service="${k}"]`);
        if(bar){ bar.style.height = (v/maxV*100)+'%'; const tip=bar.querySelector('.tip'); if(tip) tip.textContent = `${v} servicios`; }
      });
    }

    async function tryRemote(){
      // Intento opcional de cargar datos reales desde backend, si existe /api/metrics/monthly
      try{
        const up = await fetch(API_BASE + '/healthz', {cache:'no-store'}); if(!up.ok) return;
        const r = await fetch(API_BASE + '/api/metrics/monthly', {cache:'no-store'});
        if(!r.ok) return; const js = await r.json();
        if(Array.isArray(js) && js.length){ window.__remoteMonthly = js; }
      }catch(e){ /* fallback local */ }
    }

    document.addEventListener('DOMContentLoaded', async ()=>{
      renderSkeleton();
      await tryRemote();
      update(localMonthly.length-1); // arranca en agosto
    });
  })();

</script>
</body>
</html>
